proc client(x:ischannel[string]) {
  while true do
    line := read x;
    println line;
  done
}

proc server(x:oschannel[string]) {
  for var i in 0 upto 9 do
    write$ x,i.str;
  done;
}

proc launch() {
  inp,out:= mk_ioschannel_pair[string]();
  spawn_fthread { client(inp); };
  spawn_fthread { server (out); };
}

launch;
println$ "Launched!";
